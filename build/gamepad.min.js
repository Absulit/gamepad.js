var _=Object.defineProperty;var tt=a=>{throw TypeError(a)};var it=(a,i,t)=>i in a?_(a,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[i]=t;var g=(a,i)=>_(a,"name",{value:i,configurable:!0});var T=(a,i,t)=>it(a,typeof i!="symbol"?i+"":i,t),q=(a,i,t)=>i.has(a)||tt("Cannot "+t);var e=(a,i,t)=>(q(a,i,"read from private field"),t?t.call(a):i.get(a)),n=(a,i,t)=>i.has(a)?tt("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(a):i.set(a,t),s=(a,i,t,o)=>(q(a,i,"write to private field"),o?o.call(a,t):i.set(a,t),t),H=(a,i,t)=>(q(a,i,"access private method"),t);var nt={buttons:{RJB:0,INDEX:1,HAND:2,A:3,B:4,MENU:5},axes:{LJX:{x:0,y:1},RJX:{x:2,y:3}}},ot={buttons:{LJB:0,INDEX:1,HAND:2,X:3,Y:4,MENU:5},axes:{LJX:{x:0,y:1},RJX:{x:2,y:3}}},K={buttons:{A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,VIEW:8,MENU:9,LJB:10,RJB:11,UP:12,DOWN:13,LEFT:14,RIGHT:15},axes:{LJX:{x:0,y:1},RJX:{x:2,y:3}}},at={buttons:{A:0,B:1,X:3,Y:2,LB:4,RB:5,VIEW:8,MENU:9,LJB:10,RJB:11,UP:12,DOWN:13,LEFT:14,RIGHT:15},axes:{LJX:{x:0,y:1},RJX:{x:2,y:3},LT:4,RT:5}},rt={buttons:{SELECT:0,BACK:1,UP:2,DOWN:3,LEFT:4,RIGHT:5}},ht={"Microsoft Controller (STANDARD GAMEPAD Vendor: 045e Product: 02dd)":{mapping:K},"045e-02dd-Microsoft X-Box One pad (Firmware 2015)":{mapping:at},right:{mapping:nt},left:{mapping:ot},remote:{mapping:rt}};var et=Math.PI*2,C,L,M,m,A,D,B,I,u,p,O,P,w,S,z,b=class b extends EventTarget{constructor(t,o){super();n(this,S);n(this,C,!1);n(this,L,!0);n(this,M,null);n(this,m,null);n(this,A,!1);n(this,D,0);n(this,B,0);n(this,I,0);n(this,u,!1);n(this,p,0);n(this,O,0);n(this,P,0);n(this,w,0);s(this,M,t),s(this,m,o)}get name(){return e(this,M)}get index(){return e(this,m)}get x(){return e(this,P)}get y(){return e(this,w)}set debug(t){s(this,A,t)}get angle(){return e(this,D)}get distance(){return e(this,B)}get proportion(){return e(this,I)}get touched(){return e(this,u)}get value(){return e(this,p)}set value(t){s(this,O,e(this,p)),s(this,p,t),s(this,u,-.9<t),e(this,O)===e(this,p)&&e(this,p)===0&&s(this,u,!1),e(this,u)?s(this,p,(e(this,p)+1)*.5):s(this,p,0),H(this,S,z).call(this)}setProperties({pressed:t,touched:o,value:c,x:h,y:r}){this.pressed=t,s(this,u,o),s(this,P,h),s(this,w,r),s(this,p,c),h&&r&&(s(this,B,Math.sqrt(h*h+r*r)),s(this,D,Math.atan2(-r,h)),s(this,I,e(this,D)/et),e(this,D)<0&&s(this,D,e(this,D)+et),s(this,u,Math.abs(h)>.1||Math.abs(r)>.1)),H(this,S,z).call(this)}onPushed(t){this.addEventListener(b.PUSHED,t)}onReleased(t){this.addEventListener(b.RELEASED,t)}};C=new WeakMap,L=new WeakMap,M=new WeakMap,m=new WeakMap,A=new WeakMap,D=new WeakMap,B=new WeakMap,I=new WeakMap,u=new WeakMap,p=new WeakMap,O=new WeakMap,P=new WeakMap,w=new WeakMap,S=new WeakSet,z=g(function(){if(e(this,u)&&!e(this,C)&&(this.dispatchEvent(new Event(b.PUSHED)),s(this,C,!0),s(this,L,!1),e(this,A))){let t=e(this,m);if(typeof e(this,m)=="object"){let{x:o,y:c}=e(this,m);t=`{x:${o}, y:${c}}`}console.log(`Button PUSHED: Name: ${e(this,M)}, Index: ${t}`)}!e(this,u)&&!e(this,L)&&(this.dispatchEvent(new Event(b.RELEASED)),s(this,C,!1),s(this,L,!0))},"#dispatchEventIfPushed"),g(b,"Button"),T(b,"PUSHED","PUSHED"),T(b,"RELEASED","RELEASED");var G=b,E,X,y,U,Z=class Z extends EventTarget{constructor(t,o){super();n(this,E,null);n(this,X,null);n(this,y,null);n(this,U,{});s(this,E,t),s(this,X,o)}set gamepad(t){s(this,E,t)}get index(){return e(this,X)}get buttons(){return e(this,U)}get pose(){return e(this,y)}set pose(t){s(this,y,t)}vibrate(t,o){e(this,E).vibrates||(o||(o=1),e(this,E).vibrates=!0,e(this,E).vibrationActuator?.playEffect("dual-rumble",{startDelay:0,duration:t,weakMagnitude:.1,strongMagnitude:o}).then(()=>{e(this,E).vibrates=!1}))}addButton(t,o){e(this,U)[t]=new G(t,o)}get hasVibrationActuator(){return!!e(this,E).vibrationActuator}};E=new WeakMap,X=new WeakMap,y=new WeakMap,U=new WeakMap,g(Z,"Control");var V=Z,R,N,x,v,$,F,W,st,j,d=class d extends EventTarget{constructor(t){super();n(this,W);n(this,R,null);n(this,N,{});n(this,x,null);n(this,v,!1);n(this,$,g(t=>{let{gamepad:o}=t,{index:c,id:h}=o;e(this,v)&&(console.log("%cGamepadJS.CONNECTED","font-weight: bold; color: #ccc"),console.table({index:c,id:h,mapping:o.mapping}));let r=e(this,N)[`control${c}`]=new V(o,c);s(this,x,K),e(this,R)&&s(this,x,e(this,R)[o.id]?.mapping),console.log(o.mapping);for(let l in e(this,x).buttons)r.addButton(l,e(this,x).buttons[l]);for(let l in e(this,x).axes)r.addButton(l,e(this,x).axes[l]);this.dispatchEvent(new CustomEvent(d.CONNECTED,{detail:r}))},"#onGamepadConnected"));n(this,F,g(t=>{if(e(this,v)){let{gamepad:o}=t,{index:c,id:h}=o;console.log("%cGamepadJS.DISCONNECTED","font-weight: bold; color: #ccc"),console.table({index:c,id:h,mapping:o.mapping})}e(this,N)[`control${t.gamepad.index}`]=null,this.dispatchEvent(new Event(d.DISCONNECTED))},"#onGamepadDisconnected"));n(this,j,g(t=>typeof t=="object"&&t!==null,"#isObject"));T(this,"update",g(t=>{let o=H(this,W,st).call(this);for(let c in e(this,N)){let h=e(this,N)[c],r=o[h?.index],l=e(this,x);if(!(!l||!r)){h.hasVibrationActuator||(h.gamepad=r),h.pose=r.pose;for(let J in l.buttons){let f=h.buttons[J],Y=r.buttons[f.index];f.debug=e(this,v),f.setProperties(Y)}for(let J in l.axes){let f=l.axes[J],Y=e(this,j).call(this,f),k=h.buttons[J];k.debug=e(this,v),Y?k.setProperties({x:r.axes[f.x],y:r.axes[f.y]}):k.value=r.axes[f]}}}t(e(this,N))},"update"));if(d.instance)return d.instance;d.instance=this,s(this,R,t),window.addEventListener("gamepadconnected",e(this,$)),window.addEventListener("gamepaddisconnected",e(this,F))}onConnected(t){this.addEventListener(d.CONNECTED,t)}onDisconnected(t){this.addEventListener(d.DISCONNECTED,t)}set debug(t){s(this,v,t)}};R=new WeakMap,N=new WeakMap,x=new WeakMap,v=new WeakMap,$=new WeakMap,F=new WeakMap,W=new WeakSet,st=g(function(){return navigator.getGamepads()},"#getGamepads"),j=new WeakMap,g(d,"GamepadJS"),T(d,"instance"),T(d,"CONNECTED","CONNECTED"),T(d,"DISCONNECTED","DISCONNECTED");var Q=d;export{G as Button,V as Control,Q as GamepadJS,ht as gamepadInfo};
