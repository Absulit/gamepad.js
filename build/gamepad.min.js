var z=Object.defineProperty;var Q=o=>{throw TypeError(o)};var tt=(o,s,t)=>s in o?z(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t;var E=(o,s)=>z(o,"name",{value:s,configurable:!0});var C=(o,s,t)=>tt(o,typeof s!="symbol"?s+"":s,t),j=(o,s,t)=>s.has(o)||Q("Cannot "+t);var e=(o,s,t)=>(j(o,s,"read from private field"),t?t.call(o):s.get(o)),a=(o,s,t)=>s.has(o)?Q("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(o):s.set(o,t),i=(o,s,t,n)=>(j(o,s,"write to private field"),n?n.call(o,t):s.set(o,t),t),X=(o,s,t)=>(j(o,s,"access private method"),t);var et={buttons:{RJB:0,INDEX:1,HAND:2,A:3,B:4,MENU:5},axes:{LJX:{x:0,y:1},RJX:{x:2,y:3}}},st={buttons:{LJB:0,INDEX:1,HAND:2,X:3,Y:4,MENU:5},axes:{LJX:{x:0,y:1},RJX:{x:2,y:3}}},Y={buttons:{A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,VIEW:8,MENU:9,LJB:10,RJB:11,UP:12,DOWN:13,LEFT:14,RIGHT:15},axes:{LJX:{x:0,y:1},RJX:{x:2,y:3}}},it={buttons:{A:0,B:1,X:3,Y:2,LB:4,RB:5,VIEW:8,MENU:9,LJB:10,RJB:11,UP:12,DOWN:13,LEFT:14,RIGHT:15},axes:{LJX:{x:0,y:1},RJX:{x:2,y:3},LT:4,RT:5}},nt={buttons:{SELECT:0,BACK:1,UP:2,DOWN:3,LEFT:4,RIGHT:5}},ot={"Microsoft Controller (STANDARD GAMEPAD Vendor: 045e Product: 02dd)":{mapping:Y},"045e-02dd-Microsoft X-Box One pad (Firmware 2015)":{mapping:it},right:{mapping:et},left:{mapping:st},remote:{mapping:nt}};var Z=Math.PI*2,L,M,R,D,A,N,B,I,u,l,O,P,k,f=class f extends EventTarget{constructor(t,n){super();a(this,P);a(this,L,!1);a(this,M,!0);a(this,R,null);a(this,D,null);a(this,A,!1);a(this,N,0);a(this,B,0);a(this,I,0);a(this,u,!1);a(this,l,0);a(this,O,0);i(this,R,t),i(this,D,n)}get name(){return e(this,R)}get index(){return e(this,D)}set debug(t){i(this,A,t)}get angle(){return e(this,N)}get distance(){return e(this,B)}get proportion(){return e(this,I)}get touched(){return e(this,u)}get value(){return e(this,l)}set value(t){i(this,O,e(this,l)),i(this,l,t),i(this,u,-.9<t),e(this,O)===e(this,l)&&e(this,l)===0&&i(this,u,!1),e(this,u)&&i(this,l,(e(this,l)+1)*.5),X(this,P,k).call(this)}setProperties({pressed:t,touched:n,value:p,x:c,y:h}){if(this.pressed=t,i(this,u,n),this.x=c,this.y=h,i(this,l,p),this.x&&this.y){let{x:r,y:b}=this;i(this,B,Math.sqrt(r*r+b*b)),i(this,N,Math.atan2(-b,r)),i(this,I,e(this,N)/Z),e(this,N)<0&&i(this,N,e(this,N)+Z),i(this,u,Math.abs(r)>.1||Math.abs(b)>.1)}X(this,P,k).call(this)}onPushed(t){this.addEventListener(f.PUSHED,t)}onReleased(t){this.addEventListener(f.RELEASED,t)}};L=new WeakMap,M=new WeakMap,R=new WeakMap,D=new WeakMap,A=new WeakMap,N=new WeakMap,B=new WeakMap,I=new WeakMap,u=new WeakMap,l=new WeakMap,O=new WeakMap,P=new WeakSet,k=E(function(){if(e(this,u)&&!e(this,L)&&(this.dispatchEvent(new Event(f.PUSHED)),i(this,L,!0),i(this,M,!1),e(this,A))){let t=e(this,D);if(typeof e(this,D)=="object"){let{x:n,y:p}=e(this,D);t=`{x:${n}, y:${p}}`}console.log(`Button PUSHED: Name: ${e(this,R)}, Index: ${t}`)}!e(this,u)&&!e(this,M)&&(this.dispatchEvent(new Event(f.RELEASED)),i(this,L,!1),i(this,M,!0))},"#dispatchEventIfPushed"),E(f,"Button"),C(f,"PUSHED","PUSHED"),C(f,"RELEASED","RELEASED");var U=f,g,w,S,K=class K extends EventTarget{constructor(t,n){super();a(this,g,null);a(this,w,null);a(this,S,{});i(this,g,t),i(this,w,n)}set gamepad(t){i(this,g,t)}get index(){return e(this,w)}get buttons(){return e(this,S)}vibrate(t,n){e(this,g).vibrates||(n||(n=1),e(this,g).vibrates=!0,e(this,g).vibrationActuator?.playEffect("dual-rumble",{startDelay:0,duration:t,weakMagnitude:.1,strongMagnitude:n}).then(()=>{e(this,g).vibrates=!1}))}addButton(t,n){e(this,S)[t]=new U(t,n)}get hasVibrationActuator(){return!!e(this,g).vibrationActuator}};g=new WeakMap,w=new WeakMap,S=new WeakMap,E(K,"Control");var J=K,y,v,x,T,H,G,V,_,$,d=class d extends EventTarget{constructor(t){super();a(this,V);a(this,y,null);a(this,v,{});a(this,x,null);a(this,T,!1);a(this,H,E(t=>{let{gamepad:n}=t,{index:p,id:c}=n;e(this,T)&&(console.log("%cGamepadJS.CONNECTED","font-weight: bold; color: #ccc"),console.table({index:p,id:c,mapping:n.mapping}));let h=e(this,v)[`control${p}`]=new J(n,p);i(this,x,Y),e(this,y)&&i(this,x,e(this,y)[n.id]?.mapping),console.log(n.mapping);for(let r in e(this,x).buttons)h.addButton(r,e(this,x).buttons[r]);for(let r in e(this,x).axes)h.addButton(r,e(this,x).axes[r]);this.dispatchEvent(new CustomEvent(d.CONNECTED,{detail:h}))},"#onGamepadConnected"));a(this,G,E(t=>{if(e(this,T)){let{gamepad:n}=t,{index:p,id:c}=n;console.log("%cGamepadJS.DISCONNECTED","font-weight: bold; color: #ccc"),console.table({index:p,id:c,mapping:n.mapping})}e(this,v)[`control${t.gamepad.index}`]=null,this.dispatchEvent(new Event(d.DISCONNECTED))},"#onGamepadDisconnected"));a(this,$,E(t=>typeof t=="object"&&t!==null,"#isObject"));C(this,"update",E(t=>{let n=X(this,V,_).call(this);for(let p in e(this,v)){let c=e(this,v)[p],h=n[c?.index],r=e(this,x);if(!(!r||!h)){c.hasVibrationActuator||(c.gamepad=h),c.pose=h.pose;for(let b in r.buttons){let m=c.buttons[b],F=h.buttons[m.index];m.debug=e(this,T),m.setProperties(F)}for(let b in r.axes){let m=r.axes[b],F=e(this,$).call(this,m),W=c.buttons[b];W.debug=e(this,T),F?W.setProperties({x:h.axes[m.x],y:h.axes[m.y]}):W.value=h.axes[m]}}}t(e(this,v))},"update"));if(d.instance)return d.instance;d.instance=this,i(this,y,t),window.addEventListener("gamepadconnected",e(this,H)),window.addEventListener("gamepaddisconnected",e(this,G))}onConnected(t){this.addEventListener(d.CONNECTED,t)}onDisconnected(t){this.addEventListener(d.DISCONNECTED,t)}set debug(t){i(this,T,t)}};y=new WeakMap,v=new WeakMap,x=new WeakMap,T=new WeakMap,H=new WeakMap,G=new WeakMap,V=new WeakSet,_=E(function(){return navigator.getGamepads()},"#getGamepads"),$=new WeakMap,E(d,"GamepadJS"),C(d,"instance"),C(d,"CONNECTED","CONNECTED"),C(d,"DISCONNECTED","DISCONNECTED");var q=d;export{U as Button,J as Control,q as GamepadJS,ot as gamepadInfo};
